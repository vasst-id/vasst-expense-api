# üîó **VASST Communication Agent API Documentation**

## **Base URL:** `/v0`

---

## üîê **Authentication**

### **Bearer Token Authentication**
Most endpoints require JWT authentication via `Authorization: Bearer <token>` header.

### **Role-Based Access Control**
- **SuperAdmin (Role ID: 99)**: Full access to all administrative endpoints
- **Public**: No authentication required for specific endpoints

---

## üìä **API Response Format**

All endpoints return responses in the following format:

```json
{
  "success": true|false,
  "data": any,
  "error": "string" // Only present when success is false
}
```

---

# üë§ **USER ENDPOINTS**

## **üîì Public Authentication**

### **POST /v0/auth/login**
Login endpoint for user authentication.

**Request Body:**
```json
{
  "username": "string (required)",
  "password": "string (required)"
}
```

**Response (200):**
```json
{
  "success": true,
  "data": {
    "access_token": "jwt_token_string",
    "user_id": "uuid",
    "organization_id": "uuid", 
    "username": "string",
    "role_id": 1
  }
}
```

**Error Responses:**
- `400`: Invalid request body
- `401`: Invalid credentials
- `404`: User not found

---

## **üîí SuperAdmin User Management**

**Authentication Required:** SuperAdmin (Role ID: 99)

### **GET /v0/admin/users**
Get all users with pagination.

**Query Parameters:**
- `limit` (optional): Number of results (default: 10)
- `offset` (optional): Pagination offset (default: 0)

**Response (200):**
```json
{
  "success": true,
  "data": [
    {
      "user_id": "uuid",
      "organization_id": "uuid",
      "role_id": 1,
      "user_fullname": "string",
      "phone_number": "string",
      "username": "string",
      "is_active": true,
      "created_at": "timestamp",
      "updated_at": "timestamp"
    }
  ]
}
```

### **GET /v0/admin/users/:id**
Get user by ID.

**Path Parameters:**
- `id`: User UUID

**Response (200):** Same as individual user object above
**Error Responses:**
- `400`: Invalid user ID format
- `404`: User not found

### **POST /v0/admin/users**
Create a new user.

**Request Body:**
```json
{
  "phone_number": "string (required)",
  "user_fullname": "string (required)",
  "username": "string (required)",
  "password": "string (required)",
  "organization_id": "uuid (required)",
  "role_id": 1,
  "is_active": true
}
```

**Response (201):** Returns created user object
**Error Responses:**
- `409`: User already exists (phone/username conflict)

### **PUT /v0/admin/users/:id**
Update an existing user.

**Path Parameters:**
- `id`: User UUID

**Request Body:**
```json
{
  "phone_number": "string",
  "user_fullname": "string", 
  "username": "string",
  "password": "string",
  "role_id": 1,
  "is_active": true
}
```

### **DELETE /v0/admin/users/:id**
Delete a user.

**Path Parameters:**
- `id`: User UUID

**Response (200):**
```json
{
  "success": true,
  "data": "User deleted successfully"
}
```

### **GET /v0/admin/users/phone/:phone**
Get user by phone number.

**Path Parameters:**
- `phone`: Phone number string

### **GET /v0/admin/users/username/:username**
Get user by username.

**Path Parameters:**
- `username`: Username string

### **POST /v0/admin/users/:id/reset-password**
Reset user password.

**Path Parameters:**
- `id`: User UUID

**Request Body:**
```json
{
  "old_password": "string (required)",
  "new_password": "string (required)"
}
```

### **POST /v0/admin/users/:id/generate-password**
Generate new password for user.

**Path Parameters:**
- `id`: User UUID

**Request Body:**
```json
{
  "password": "string (optional - generates random if not provided)"
}
```

---

# üè¢ **ORGANIZATION ENDPOINTS**

**Authentication Required:** SuperAdmin (Role ID: 99)

## **Organization Management**

### **GET /v0/organizations**
List all organizations with pagination.

**Query Parameters:**
- `limit` (optional): Number of results (default: 10)
- `offset` (optional): Pagination offset (default: 0)

**Response (200):**
```json
{
  "success": true,
  "data": [
    {
      "organization_id": "uuid",
      "organization_name": "string",
      "organization_code": "string",
      "organization_description": "string",
      "organization_address": "string",
      "organization_phone": "string",
      "organization_email": "string",
      "organization_website": "string",
      "category_id": 1,
      "is_active": true,
      "created_at": "timestamp",
      "updated_at": "timestamp"
    }
  ]
}
```

### **GET /v0/organizations/:id**
Get organization by ID.

**Path Parameters:**
- `id`: Organization UUID

### **GET /v0/organizations/code/:code**
Get organization by code.

**Path Parameters:**
- `code`: Organization code string

### **POST /v0/organizations**
Create new organization.

**Request Body:**
```json
{
  "organization_name": "string (required)",
  "organization_code": "string (required)",
  "organization_description": "string",
  "organization_address": "string",
  "organization_phone": "string",
  "organization_email": "string",
  "organization_website": "string", 
  "category_id": 1,
  "is_active": true
}
```

### **PUT /v0/organizations/:id**
Update organization.

**Path Parameters:**
- `id`: Organization UUID

**Request Body:** Same as create, all fields optional

### **DELETE /v0/organizations/:id**
Delete organization.

**Path Parameters:**
- `id`: Organization UUID

## **Organization Categories**

### **GET /v0/organizations/categories**
List all organization categories.

### **GET /v0/organizations/categories/:id**
Get category by ID.

**Path Parameters:**
- `id`: Category ID (integer)

### **POST /v0/organizations/categories**
Create new category.

**Request Body:**
```json
{
  "category_name": "string (required)",
  "category_description": "string"
}
```

### **PUT /v0/organizations/categories/:id**
Update category.

### **DELETE /v0/organizations/categories/:id**
Delete category.

## **Organization Settings**

### **GET /v0/organizations/:id/settings**
Get organization settings.

**Path Parameters:**
- `id`: Organization UUID

### **PUT /v0/organizations/:id/settings**
Update organization settings.

**Path Parameters:**
- `id`: Organization UUID

## **Knowledge Management**

### **GET /v0/organizations/:id/knowledge**
List knowledge entries for organization.

**Path Parameters:**
- `id`: Organization UUID

### **GET /v0/organizations/knowledge/:id**
Get knowledge entry by ID.

**Path Parameters:**
- `id`: Knowledge UUID

### **POST /v0/organizations/:id/knowledge**
Create knowledge entry.

**Path Parameters:**
- `id`: Organization UUID

**Request Body:**
```json
{
  "knowledge_type": 1,
  "title": "string (required)",
  "content": "string (required)",
  "description": "string",
  "is_active": true
}
```

### **POST /v0/organizations/:id/knowledge/with-file**
Create knowledge entry with file upload.

**Path Parameters:**
- `id`: Organization UUID

**Form Data:**
- `file`: File upload (required)
- `knowledge_type`: Integer (required)
- `title`: String (required)
- `content`: String (required)
- `description`: String (optional)
- `is_active`: Boolean (optional)

### **PUT /v0/organizations/knowledge/:id**
Update knowledge entry.

**Path Parameters:**
- `id`: Knowledge UUID

### **DELETE /v0/organizations/knowledge/:id**
Delete knowledge entry.

**Path Parameters:**
- `id`: Knowledge UUID


## **Integrations**

### **GET /v0/organizations/:id/integrations**
List integrations for organization.

### **POST /v0/organizations/:id/integrations**
Create new integration.

### **PUT /v0/organizations/integrations/:id**
Update integration.

### **DELETE /v0/organizations/integrations/:id**
Delete integration.

---

# üéØ **LEADS ENDPOINTS**

## **üîì Public Lead Creation**

### **POST /v0/leads**
Create a new lead (public endpoint for lead generation).

**Request Body:**
```json
{
  "name": "string (required)",
  "phone_number": "string (required)",
  "email": "string (optional)",
  "business_name": "string (optional)",
  "business_address": "string (optional)",
  "business_phone_number": "string (optional)",
  "business_email": "string (optional)",
  "business_website": "string (optional)",
  "business_industry": "string (optional)",
  "business_size": "string (optional)"
}
```

**Response (201):**
```json
{
  "success": true,
  "data": {
    "lead_id": "uuid",
    "name": "string",
    "phone_number": "string",
    "email": "string",
    "business_name": "string",
    "business_address": "string",
    "business_phone_number": "string",
    "business_email": "string",
    "business_website": "string",
    "business_industry": "string",
    "business_size": "string",
    "created_at": "timestamp",
    "updated_at": "timestamp"
  }
}
```

**Error Responses:**
- `400`: Invalid request body
- `409`: Lead already exists (phone/email conflict)

## **üîí SuperAdmin Lead Management**

**Authentication Required:** SuperAdmin (Role ID: 99)

### **GET /v0/admin/leads**
List all leads with pagination.

**Query Parameters:**
- `limit` (optional): Number of results (default: 10)
- `offset` (optional): Pagination offset (default: 0)

**Response (200):**
```json
{
  "success": true,
  "data": [
    {
      "lead_id": "uuid",
      "name": "string",
      "phone_number": "string",
      "email": "string",
      "business_name": "string",
      "business_address": "string",
      "business_phone_number": "string",
      "business_email": "string",
      "business_website": "string",
      "business_industry": "string",
      "business_size": "string",
      "created_at": "timestamp",
      "updated_at": "timestamp"
    }
  ]
}
```

### **GET /v0/admin/leads/:id**
Get lead by ID.

**Path Parameters:**
- `id`: Lead UUID

**Response (200):** Returns individual lead object
**Error Responses:**
- `400`: Invalid lead ID format
- `404`: Lead not found

### **PUT /v0/admin/leads/:id**
Update lead details.

**Path Parameters:**
- `id`: Lead UUID

**Request Body:**
```json
{
  "name": "string (optional)",
  "phone_number": "string (optional)",
  "email": "string (optional)",
  "business_name": "string (optional)",
  "business_address": "string (optional)",
  "business_phone_number": "string (optional)",
  "business_email": "string (optional)",
  "business_website": "string (optional)",
  "business_industry": "string (optional)",
  "business_size": "string (optional)"
}
```

**Error Responses:**
- `404`: Lead not found
- `409`: Phone/email already in use

### **GET /v0/admin/leads/phone/:phone**
Get lead by phone number.

**Path Parameters:**
- `phone`: Phone number string

### **GET /v0/admin/leads/email/:email**
Get lead by email.

**Path Parameters:**
- `email`: Email address string

---

# ‚ö° **Common Error Codes**

- `400 Bad Request`: Invalid request format or missing required fields
- `401 Unauthorized`: Authentication required or invalid token
- `403 Forbidden`: Insufficient permissions (non-SuperAdmin accessing admin endpoints)
- `404 Not Found`: Resource not found
- `409 Conflict`: Resource already exists (duplicate phone/email/username)
- `500 Internal Server Error`: Server-side error

---

# üìù **Usage Examples**

## **Create Lead (Public)**
```bash
curl -X POST http://localhost:8080/v0/leads \
  -H "Content-Type: application/json" \
  -d '{
    "name": "John Doe",
    "phone_number": "+1234567890",
    "email": "john@example.com",
    "business_name": "Acme Corp"
  }'
```

## **Login and Get Users (SuperAdmin)**
```bash
# Login
TOKEN=$(curl -X POST http://localhost:8080/v0/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"password"}' | jq -r '.data.access_token')

# Get users
curl -X GET http://localhost:8080/v0/admin/users \
  -H "Authorization: Bearer $TOKEN"
```

## **Create Organization (SuperAdmin)**
```bash
curl -X POST http://localhost:8080/v0/organizations \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "organization_name": "Tech Startup",
    "organization_code": "TECH001",
    "category_id": 1
  }'
```

## **Create Knowledge Entry with File**
```bash
curl -X POST http://localhost:8080/v0/organizations/{org_id}/knowledge/with-file \
  -H "Authorization: Bearer $TOKEN" \
  -F "file=@knowledge.pdf" \
  -F "knowledge_type=1" \
  -F "title=Product Manual" \
  -F "content=Complete product documentation" \
  -F "is_active=true"
```

---

# üìã **Endpoint Summary**

## **Public Endpoints (No Authentication)**
- `POST /v0/auth/login` - User login
- `POST /v0/leads` - Create lead

## **SuperAdmin Only Endpoints (Role ID: 99)**
- All `/v0/admin/users/*` - User management
- All `/v0/organizations/*` - Organization management
- All `/v0/admin/leads/*` - Lead management

## **Total Endpoints: 50+**
- **User Management**: 10 endpoints
- **Organization Management**: 25+ endpoints
- **Lead Management**: 6 endpoints
- **Webhook Endpoints**: 5 endpoints
- **Authentication**: 1 endpoint

This comprehensive API documentation covers all endpoints in the VASST Communication Agent v0 API, including authentication requirements, request/response formats, error handling, and practical usage examples. 